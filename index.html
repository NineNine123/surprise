<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Catch the Cat! üê±</title>
    <link rel="preconnect" href="https://rsms.me/" />
    <link rel="stylesheet" href="https://rsms.me/inter/inter.css" />
    <style>
      :root {
        --bg1: #fef6ff;
        --bg2: #e8f7ff;
        --card: #fff;
        --ink: #1f2937;
        --accent: #7c3aed;
        --success: #10b981;
        --shadow: 0 20px 60px rgba(0, 0, 0, 0.12);
      }

      * {
        box-sizing: border-box;
        margin: 0;
        padding: 0;
      }

      html,
      body {
        height: 100%;
        font-family: "Inter", system-ui, sans-serif;
        -webkit-font-smoothing: antialiased;
      }

      body {
        background: radial-gradient(
            1200px 800px at 20% 0%,
            var(--bg1),
            #fff 40%
          ),
          radial-gradient(1200px 800px at 100% 100%, var(--bg2), #fff 40%);
        color: var(--ink);
        display: flex;
        align-items: center;
        justify-content: center;
        overflow: hidden;
      }

      .stage {
        position: relative;
        width: min(900px, 92vw);
        height: min(70vh, 560px);
        border-radius: 24px;
        background: var(--card);
        box-shadow: var(--shadow);
        overflow: hidden;
        user-select: none;
      }

      .hud {
        position: absolute;
        top: 14px;
        left: 14px;
        background: rgba(0, 0, 0, 0.05);
        padding: 8px 12px;
        border-radius: 12px;
        font-size: 14px;
        font-weight: 500;
        z-index: 10;
      }

      .cta {
        position: absolute;
        top: 14px;
        right: 14px;
        padding: 10px 16px;
        border: none;
        border-radius: 12px;
        background: #111;
        color: #fff;
        font-size: 14px;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.2s ease;
        z-index: 10;
      }

      .cta:hover {
        background: #333;
        transform: translateY(-1px);
      }

      /* Cat */
      #cat {
        position: absolute;
        width: 90px;
        height: 90px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        touch-action: none;
        transition: box-shadow 0.2s ease;
        box-shadow: 0 10px 30px rgba(124, 58, 237, 0.28);
        z-index: 5;
        will-change: transform;
      }

      #cat::before {
        content: "";
        position: absolute;
        inset: 0;
        border-radius: 50%;
        background: radial-gradient(
            60px 60px at 35% 35%,
            #fff,
            rgba(255, 255, 255, 0.4)
          ),
          conic-gradient(
            from 120deg,
            #ffde9e,
            #ffd3e4,
            #c6e7ff,
            #c1ffe0,
            #ffde9e
          );
        filter: saturate(1.1);
      }

      .sprite {
        position: relative;
        font-size: 42px;
        z-index: 1;
        transform: translateY(-2px);
      }

      .wiggle {
        animation: wiggle 1s infinite ease-in-out;
      }

      @keyframes wiggle {
        0%,
        100% {
          transform: rotate(0deg);
        }
        25% {
          transform: rotate(-8deg);
        }
        75% {
          transform: rotate(8deg);
        }
      }

      .bubble {
        position: absolute;
        left: 50%;
        top: -56px;
        transform: translateX(-50%);
        background: #111;
        color: #fff;
        padding: 8px 14px;
        border-radius: 16px;
        font-size: 14px;
        font-weight: 500;
        white-space: nowrap;
        box-shadow: 0 8px 20px rgba(0, 0, 0, 0.2);
        opacity: 0;
        pointer-events: none;
        transition: opacity 0.3s ease;
      }

      .bubble::after {
        content: "";
        position: absolute;
        left: 50%;
        bottom: -8px;
        transform: translateX(-50%);
        border: 8px solid transparent;
        border-top-color: #111;
      }

      .bubble.show {
        opacity: 1;
      }

      /* Confetti */
      .confetti {
        position: absolute;
        inset: 0;
        pointer-events: none;
        overflow: hidden;
      }

      .confetti span {
        position: absolute;
        font-size: 18px;
        animation: confetti-fall 1s ease-out forwards;
        will-change: transform, opacity;
      }

      @keyframes confetti-fall {
        0% {
          transform: translateY(0) rotate(0deg) scale(1);
          opacity: 1;
        }
        100% {
          transform: translateY(300px) rotate(720deg) scale(0.8);
          opacity: 0;
        }
      }

      .footer {
        position: absolute;
        bottom: 8px;
        left: 0;
        right: 0;
        text-align: center;
        font-size: 12px;
        color: #9ca3af;
      }

      @media (max-width: 480px) {
        .hud,
        .cta {
          font-size: 13px;
        }
        #cat {
          width: 80px;
          height: 80px;
        }
        .sprite {
          font-size: 36px;
        }
      }
    </style>
  </head>
  <body>
    <div
      class="stage"
      id="stage"
      role="application"
      aria-label="Catch the Cat Game"
    >
      <div class="hud" aria-live="polite">Catch the cat! Tap fast üêæ</div>
      <button class="cta" id="reset" hidden aria-label="Play again">
        Play Again
      </button>

      <button
        id="cat"
        role="button"
        aria-label="Catch the cat"
        tabindex="0"
        aria-describedby="bubble"
      >
        <div class="bubble" id="bubble" role="status">Catch me!</div>
        <div class="sprite wiggle">üê±</div>
      </button>

      <div class="confetti" id="confetti" aria-hidden="true"></div>
      <div class="footer">made with üíñ & vanilla JS</div>
    </div>

    <script>
      (() => {
        // Elements
        const stage = document.getElementById("stage");
        const cat = document.getElementById("cat");
        const bubble = document.getElementById("bubble");
        const confetti = document.getElementById("confetti");
        const resetBtn = document.getElementById("reset");

        // Game state
        let pos = { x: 0, y: 0 };
        let vel = { x: 2.8, y: 2.1 };
        let isCaught = false;
        let animationId = null;
        let lastTime = 0;

        const CAT_SIZE = 90;
        const DODGE_DISTANCE = 120;
        const BOUNCE_DAMPING = 1.0;
        const HUD_HEIGHT = 50;

        const winMessages = [
          "You caught me! You're quick üò∫",
          "Fast paws! Nice catch üêæ",
          "Winner! Cat-chieved! ‚ú®",
          "Gotcha! You're awesome üéâ",
          "Purr-fect timing! üèÜ",
        ];

        // Initialize
        function init() {
          resetGame();
          setupEventListeners();
          requestAnimationFrame(gameLoop);
        }

        // Random safe position
        function getRandomPosition() {
          const rect = stage.getBoundingClientRect();
          const pad = 16;
          const maxX = rect.width - CAT_SIZE - pad * 2;
          const maxY = rect.height - CAT_SIZE - pad * 2 - HUD_HEIGHT;

          return {
            x: pad + Math.random() * maxX,
            y: HUD_HEIGHT + pad + Math.random() * maxY,
          };
        }

        // Move cat
        function moveCat(x, y) {
          pos.x = x;
          pos.y = y;
          cat.style.transform = `translate(${x}px, ${y}px)`;
        }

        // Dodge logic
        function tryDodge(pointerX, pointerY) {
          if (isCaught) return;

          const catRect = cat.getBoundingClientRect();
          const catCenter = {
            x: catRect.left + catRect.width / 2,
            y: catRect.top + catRect.height / 2,
          };

          const dx = pointerX - catCenter.x;
          const dy = pointerY - catCenter.y;
          const dist = Math.hypot(dx, dy);

          if (dist < DODGE_DISTANCE) {
            // Push away from pointer
            const angle = Math.atan2(dy, dx);
            const force = (DODGE_DISTANCE - dist) / DODGE_DISTANCE;
            vel.x += Math.cos(angle) * force * 8;
            vel.y += Math.sin(angle) * force * 8;
          }
        }

        // Game loop
        function gameLoop(timestamp) {
          if (!lastTime) lastTime = timestamp;
          const delta = Math.min(timestamp - lastTime, 50); // Cap delta
          lastTime = timestamp;

          if (!isCaught) {
            updateCat(delta);
          }

          animationId = requestAnimationFrame(gameLoop);
        }

        function updateCat(delta) {
          const rect = stage.getBoundingClientRect();
          const scaledDelta = delta * 0.06;

          // Update position
          pos.x += vel.x * scaledDelta;
          pos.y += vel.y * scaledDelta;

          // Bounce
          if (pos.x <= 0 || pos.x >= rect.width - CAT_SIZE) {
            vel.x = -vel.x * BOUNCE_DAMPING;
            pos.x = Math.max(0, Math.min(rect.width - CAT_SIZE, pos.x));
          }
          if (pos.y <= HUD_HEIGHT || pos.y >= rect.height - CAT_SIZE) {
            vel.y = -vel.y * BOUNCE_DAMPING;
            pos.y = Math.max(
              HUD_HEIGHT,
              Math.min(rect.height - CAT_SIZE, pos.y)
            );
          }

          moveCat(pos.x, pos.y);
        }

        // Catch cat
        function catchCat() {
          if (isCaught) return;
          isCaught = true;

          bubble.textContent =
            winMessages[Math.floor(Math.random() * winMessages.length)];
          bubble.classList.add("show");
          cat.style.boxShadow = "0 10px 30px rgba(16, 185, 129, 0.5)";
          burstConfetti();
          resetBtn.hidden = false;
          resetBtn.focus();
        }

        // Confetti
        function burstConfetti() {
          confetti.innerHTML = "";
          const emojis = "üéâ‚ú®üí´üß°üíõüíôüíú‚≠êüåüüí•".split("");
          const rect = stage.getBoundingClientRect();

          for (let i = 0; i < 32; i++) {
            const span = document.createElement("span");
            span.textContent = emojis[i % emojis.length];
            span.style.left = `${
              rect.width / 2 + (Math.random() - 0.5) * 140
            }px`;
            span.style.top = `${
              rect.height / 2 + (Math.random() - 0.5) * 80
            }px`;
            span.style.animationDelay = `${Math.random() * 0.3}s`;
            span.style.setProperty("--rand", Math.random());
            confetti.appendChild(span);

            // Remove after animation
            setTimeout(() => span.remove(), 1500);
          }
        }

        // Reset
        function resetGame() {
          isCaught = false;
          const newPos = getRandomPosition();
          vel = {
            x: (Math.random() > 0.5 ? 1 : -1) * (2 + Math.random() * 1.5),
            y: (Math.random() > 0.5 ? 1 : -1) * (1.5 + Math.random() * 1.2),
          };

          moveCat(newPos.x, newPos.y);
          bubble.textContent = "Catch me!";
          bubble.classList.remove("show");
          cat.style.boxShadow = "0 10px 30px rgba(124, 58, 237, 0.28)";
          resetBtn.hidden = true;
          confetti.innerHTML = "";
        }

        // Event Listeners
        function setupEventListeners() {
          // Pointer events (unified mouse + touch)
          const handlePointer = (e) => {
            const pointer = e.touches ? e.touches[0] : e;
            tryDodge(pointer.clientX, pointer.clientY);
          };

          stage.addEventListener("mousemove", handlePointer);
          stage.addEventListener("touchmove", handlePointer, { passive: true });

          // Catch
          cat.addEventListener("click", catchCat);
          cat.addEventListener(
            "touchstart",
            (e) => {
              e.preventDefault();
              catchCat();
            },
            { passive: false }
          );

          cat.addEventListener("keydown", (e) => {
            if (e.key === "Enter" || e.key === " ") {
              e.preventDefault();
              catchCat();
            }
          });

          resetBtn.addEventListener("click", () => {
            resetGame();
            cat.focus();
          });

          window.addEventListener("resize", () => {
            if (!isCaught) {
              const newPos = getRandomPosition();
              moveCat(newPos.x, newPos.y);
            }
          });
        }

        // Start
        init();
      })();
    </script>
  </body>
</html>
